var Of=Object.defineProperty;var Pf=(a,o,i)=>o in a?Of(a,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[o]=i;var Te=(a,o,i)=>Pf(a,typeof o!="symbol"?o+"":o,i);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))m(_);new MutationObserver(_=>{for(const H of _)if(H.type==="childList")for(const te of H.addedNodes)te.tagName==="LINK"&&te.rel==="modulepreload"&&m(te)}).observe(document,{childList:!0,subtree:!0});function i(_){const H={};return _.integrity&&(H.integrity=_.integrity),_.referrerPolicy&&(H.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?H.credentials="include":_.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function m(_){if(_.ep)return;_.ep=!0;const H=i(_);fetch(_.href,H)}})();var Nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ff(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function Df(a){if(a.__esModule)return a;var o=a.default;if(typeof o=="function"){var i=function m(){return this instanceof m?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};i.prototype=o.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(a).forEach(function(m){var _=Object.getOwnPropertyDescriptor(a,m);Object.defineProperty(i,m,_.get?_:{enumerable:!0,get:function(){return a[m]}})}),i}function Hf(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yf={exports:{}};const zf={},Zf=Object.freeze(Object.defineProperty({__proto__:null,default:zf},Symbol.toStringTag,{value:"Module"})),Gf=Df(Zf);(function(a){(function(o){var i=function(t){var r,f=new Float64Array(16);if(t)for(r=0;r<t.length;r++)f[r]=t[r];return f},m=function(){throw new Error("no PRNG")},_=new Uint8Array(16),H=new Uint8Array(32);H[0]=9;var te=i(),se=i([1]),Se=i([56129,1]),Pt=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Af=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Nt=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Ft=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Mf=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Dt(t,r,f,e){t[r]=f>>24&255,t[r+1]=f>>16&255,t[r+2]=f>>8&255,t[r+3]=f&255,t[r+4]=e>>24&255,t[r+5]=e>>16&255,t[r+6]=e>>8&255,t[r+7]=e&255}function xt(t,r,f,e,n){var c,x=0;for(c=0;c<n;c++)x|=t[r+c]^f[e+c];return(1&x-1>>>8)-1}function Ht(t,r,f,e){return xt(t,r,f,e,16)}function dt(t,r,f,e){return xt(t,r,f,e,32)}function Uf(t,r,f,e){for(var n=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,c=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,x=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,u=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,g=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,T=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,L=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,V=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,S=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,$=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24,I=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,P=f[16]&255|(f[17]&255)<<8|(f[18]&255)<<16|(f[19]&255)<<24,O=f[20]&255|(f[21]&255)<<8|(f[22]&255)<<16|(f[23]&255)<<24,R=f[24]&255|(f[25]&255)<<8|(f[26]&255)<<16|(f[27]&255)<<24,K=f[28]&255|(f[29]&255)<<8|(f[30]&255)<<16|(f[31]&255)<<24,Y=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,A=n,j=c,B=x,M=u,U=g,E=T,d=L,l=V,p=S,h=$,y=I,b=P,C=O,N=R,D=K,F=Y,s,Z=0;Z<20;Z+=2)s=A+C|0,U^=s<<7|s>>>25,s=U+A|0,p^=s<<9|s>>>23,s=p+U|0,C^=s<<13|s>>>19,s=C+p|0,A^=s<<18|s>>>14,s=E+j|0,h^=s<<7|s>>>25,s=h+E|0,N^=s<<9|s>>>23,s=N+h|0,j^=s<<13|s>>>19,s=j+N|0,E^=s<<18|s>>>14,s=y+d|0,D^=s<<7|s>>>25,s=D+y|0,B^=s<<9|s>>>23,s=B+D|0,d^=s<<13|s>>>19,s=d+B|0,y^=s<<18|s>>>14,s=F+b|0,M^=s<<7|s>>>25,s=M+F|0,l^=s<<9|s>>>23,s=l+M|0,b^=s<<13|s>>>19,s=b+l|0,F^=s<<18|s>>>14,s=A+M|0,j^=s<<7|s>>>25,s=j+A|0,B^=s<<9|s>>>23,s=B+j|0,M^=s<<13|s>>>19,s=M+B|0,A^=s<<18|s>>>14,s=E+U|0,d^=s<<7|s>>>25,s=d+E|0,l^=s<<9|s>>>23,s=l+d|0,U^=s<<13|s>>>19,s=U+l|0,E^=s<<18|s>>>14,s=y+h|0,b^=s<<7|s>>>25,s=b+y|0,p^=s<<9|s>>>23,s=p+b|0,h^=s<<13|s>>>19,s=h+p|0,y^=s<<18|s>>>14,s=F+D|0,C^=s<<7|s>>>25,s=C+F|0,N^=s<<9|s>>>23,s=N+C|0,D^=s<<13|s>>>19,s=D+N|0,F^=s<<18|s>>>14;A=A+n|0,j=j+c|0,B=B+x|0,M=M+u|0,U=U+g|0,E=E+T|0,d=d+L|0,l=l+V|0,p=p+S|0,h=h+$|0,y=y+I|0,b=b+P|0,C=C+O|0,N=N+R|0,D=D+K|0,F=F+Y|0,t[0]=A>>>0&255,t[1]=A>>>8&255,t[2]=A>>>16&255,t[3]=A>>>24&255,t[4]=j>>>0&255,t[5]=j>>>8&255,t[6]=j>>>16&255,t[7]=j>>>24&255,t[8]=B>>>0&255,t[9]=B>>>8&255,t[10]=B>>>16&255,t[11]=B>>>24&255,t[12]=M>>>0&255,t[13]=M>>>8&255,t[14]=M>>>16&255,t[15]=M>>>24&255,t[16]=U>>>0&255,t[17]=U>>>8&255,t[18]=U>>>16&255,t[19]=U>>>24&255,t[20]=E>>>0&255,t[21]=E>>>8&255,t[22]=E>>>16&255,t[23]=E>>>24&255,t[24]=d>>>0&255,t[25]=d>>>8&255,t[26]=d>>>16&255,t[27]=d>>>24&255,t[28]=l>>>0&255,t[29]=l>>>8&255,t[30]=l>>>16&255,t[31]=l>>>24&255,t[32]=p>>>0&255,t[33]=p>>>8&255,t[34]=p>>>16&255,t[35]=p>>>24&255,t[36]=h>>>0&255,t[37]=h>>>8&255,t[38]=h>>>16&255,t[39]=h>>>24&255,t[40]=y>>>0&255,t[41]=y>>>8&255,t[42]=y>>>16&255,t[43]=y>>>24&255,t[44]=b>>>0&255,t[45]=b>>>8&255,t[46]=b>>>16&255,t[47]=b>>>24&255,t[48]=C>>>0&255,t[49]=C>>>8&255,t[50]=C>>>16&255,t[51]=C>>>24&255,t[52]=N>>>0&255,t[53]=N>>>8&255,t[54]=N>>>16&255,t[55]=N>>>24&255,t[56]=D>>>0&255,t[57]=D>>>8&255,t[58]=D>>>16&255,t[59]=D>>>24&255,t[60]=F>>>0&255,t[61]=F>>>8&255,t[62]=F>>>16&255,t[63]=F>>>24&255}function Tf(t,r,f,e){for(var n=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,c=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,x=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,u=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,g=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,T=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,L=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,V=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,S=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,$=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24,I=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,P=f[16]&255|(f[17]&255)<<8|(f[18]&255)<<16|(f[19]&255)<<24,O=f[20]&255|(f[21]&255)<<8|(f[22]&255)<<16|(f[23]&255)<<24,R=f[24]&255|(f[25]&255)<<8|(f[26]&255)<<16|(f[27]&255)<<24,K=f[28]&255|(f[29]&255)<<8|(f[30]&255)<<16|(f[31]&255)<<24,Y=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,A=n,j=c,B=x,M=u,U=g,E=T,d=L,l=V,p=S,h=$,y=I,b=P,C=O,N=R,D=K,F=Y,s,Z=0;Z<20;Z+=2)s=A+C|0,U^=s<<7|s>>>25,s=U+A|0,p^=s<<9|s>>>23,s=p+U|0,C^=s<<13|s>>>19,s=C+p|0,A^=s<<18|s>>>14,s=E+j|0,h^=s<<7|s>>>25,s=h+E|0,N^=s<<9|s>>>23,s=N+h|0,j^=s<<13|s>>>19,s=j+N|0,E^=s<<18|s>>>14,s=y+d|0,D^=s<<7|s>>>25,s=D+y|0,B^=s<<9|s>>>23,s=B+D|0,d^=s<<13|s>>>19,s=d+B|0,y^=s<<18|s>>>14,s=F+b|0,M^=s<<7|s>>>25,s=M+F|0,l^=s<<9|s>>>23,s=l+M|0,b^=s<<13|s>>>19,s=b+l|0,F^=s<<18|s>>>14,s=A+M|0,j^=s<<7|s>>>25,s=j+A|0,B^=s<<9|s>>>23,s=B+j|0,M^=s<<13|s>>>19,s=M+B|0,A^=s<<18|s>>>14,s=E+U|0,d^=s<<7|s>>>25,s=d+E|0,l^=s<<9|s>>>23,s=l+d|0,U^=s<<13|s>>>19,s=U+l|0,E^=s<<18|s>>>14,s=y+h|0,b^=s<<7|s>>>25,s=b+y|0,p^=s<<9|s>>>23,s=p+b|0,h^=s<<13|s>>>19,s=h+p|0,y^=s<<18|s>>>14,s=F+D|0,C^=s<<7|s>>>25,s=C+F|0,N^=s<<9|s>>>23,s=N+C|0,D^=s<<13|s>>>19,s=D+N|0,F^=s<<18|s>>>14;t[0]=A>>>0&255,t[1]=A>>>8&255,t[2]=A>>>16&255,t[3]=A>>>24&255,t[4]=E>>>0&255,t[5]=E>>>8&255,t[6]=E>>>16&255,t[7]=E>>>24&255,t[8]=y>>>0&255,t[9]=y>>>8&255,t[10]=y>>>16&255,t[11]=y>>>24&255,t[12]=F>>>0&255,t[13]=F>>>8&255,t[14]=F>>>16&255,t[15]=F>>>24&255,t[16]=d>>>0&255,t[17]=d>>>8&255,t[18]=d>>>16&255,t[19]=d>>>24&255,t[20]=l>>>0&255,t[21]=l>>>8&255,t[22]=l>>>16&255,t[23]=l>>>24&255,t[24]=p>>>0&255,t[25]=p>>>8&255,t[26]=p>>>16&255,t[27]=p>>>24&255,t[28]=h>>>0&255,t[29]=h>>>8&255,t[30]=h>>>16&255,t[31]=h>>>24&255}function Ve(t,r,f,e){Uf(t,r,f,e)}function Xe(t,r,f,e){Tf(t,r,f,e)}var Ae=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function zt(t,r,f,e,n,c,x){var u=new Uint8Array(16),g=new Uint8Array(64),T,L;for(L=0;L<16;L++)u[L]=0;for(L=0;L<8;L++)u[L]=c[L];for(;n>=64;){for(Ve(g,u,x,Ae),L=0;L<64;L++)t[r+L]=f[e+L]^g[L];for(T=1,L=8;L<16;L++)T=T+(u[L]&255)|0,u[L]=T&255,T>>>=8;n-=64,r+=64,e+=64}if(n>0)for(Ve(g,u,x,Ae),L=0;L<n;L++)t[r+L]=f[e+L]^g[L];return 0}function Zt(t,r,f,e,n){var c=new Uint8Array(16),x=new Uint8Array(64),u,g;for(g=0;g<16;g++)c[g]=0;for(g=0;g<8;g++)c[g]=e[g];for(;f>=64;){for(Ve(x,c,n,Ae),g=0;g<64;g++)t[r+g]=x[g];for(u=1,g=8;g<16;g++)u=u+(c[g]&255)|0,c[g]=u&255,u>>>=8;f-=64,r+=64}if(f>0)for(Ve(x,c,n,Ae),g=0;g<f;g++)t[r+g]=x[g];return 0}function Gt(t,r,f,e,n){var c=new Uint8Array(32);Xe(c,e,n,Ae);for(var x=new Uint8Array(8),u=0;u<8;u++)x[u]=e[u+16];return Zt(t,r,f,x,c)}function lt(t,r,f,e,n,c,x){var u=new Uint8Array(32);Xe(u,c,x,Ae);for(var g=new Uint8Array(8),T=0;T<8;T++)g[T]=c[T+16];return zt(t,r,f,e,n,g,u)}var ke=function(t){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var r,f,e,n,c,x,u,g;r=t[0]&255|(t[1]&255)<<8,this.r[0]=r&8191,f=t[2]&255|(t[3]&255)<<8,this.r[1]=(r>>>13|f<<3)&8191,e=t[4]&255|(t[5]&255)<<8,this.r[2]=(f>>>10|e<<6)&7939,n=t[6]&255|(t[7]&255)<<8,this.r[3]=(e>>>7|n<<9)&8191,c=t[8]&255|(t[9]&255)<<8,this.r[4]=(n>>>4|c<<12)&255,this.r[5]=c>>>1&8190,x=t[10]&255|(t[11]&255)<<8,this.r[6]=(c>>>14|x<<2)&8191,u=t[12]&255|(t[13]&255)<<8,this.r[7]=(x>>>11|u<<5)&8065,g=t[14]&255|(t[15]&255)<<8,this.r[8]=(u>>>8|g<<8)&8191,this.r[9]=g>>>5&127,this.pad[0]=t[16]&255|(t[17]&255)<<8,this.pad[1]=t[18]&255|(t[19]&255)<<8,this.pad[2]=t[20]&255|(t[21]&255)<<8,this.pad[3]=t[22]&255|(t[23]&255)<<8,this.pad[4]=t[24]&255|(t[25]&255)<<8,this.pad[5]=t[26]&255|(t[27]&255)<<8,this.pad[6]=t[28]&255|(t[29]&255)<<8,this.pad[7]=t[30]&255|(t[31]&255)<<8};ke.prototype.blocks=function(t,r,f){for(var e=this.fin?0:2048,n,c,x,u,g,T,L,V,S,$,I,P,O,R,K,Y,A,j,B,M=this.h[0],U=this.h[1],E=this.h[2],d=this.h[3],l=this.h[4],p=this.h[5],h=this.h[6],y=this.h[7],b=this.h[8],C=this.h[9],N=this.r[0],D=this.r[1],F=this.r[2],s=this.r[3],Z=this.r[4],X=this.r[5],k=this.r[6],z=this.r[7],W=this.r[8],J=this.r[9];f>=16;)n=t[r+0]&255|(t[r+1]&255)<<8,M+=n&8191,c=t[r+2]&255|(t[r+3]&255)<<8,U+=(n>>>13|c<<3)&8191,x=t[r+4]&255|(t[r+5]&255)<<8,E+=(c>>>10|x<<6)&8191,u=t[r+6]&255|(t[r+7]&255)<<8,d+=(x>>>7|u<<9)&8191,g=t[r+8]&255|(t[r+9]&255)<<8,l+=(u>>>4|g<<12)&8191,p+=g>>>1&8191,T=t[r+10]&255|(t[r+11]&255)<<8,h+=(g>>>14|T<<2)&8191,L=t[r+12]&255|(t[r+13]&255)<<8,y+=(T>>>11|L<<5)&8191,V=t[r+14]&255|(t[r+15]&255)<<8,b+=(L>>>8|V<<8)&8191,C+=V>>>5|e,S=0,$=S,$+=M*N,$+=U*(5*J),$+=E*(5*W),$+=d*(5*z),$+=l*(5*k),S=$>>>13,$&=8191,$+=p*(5*X),$+=h*(5*Z),$+=y*(5*s),$+=b*(5*F),$+=C*(5*D),S+=$>>>13,$&=8191,I=S,I+=M*D,I+=U*N,I+=E*(5*J),I+=d*(5*W),I+=l*(5*z),S=I>>>13,I&=8191,I+=p*(5*k),I+=h*(5*X),I+=y*(5*Z),I+=b*(5*s),I+=C*(5*F),S+=I>>>13,I&=8191,P=S,P+=M*F,P+=U*D,P+=E*N,P+=d*(5*J),P+=l*(5*W),S=P>>>13,P&=8191,P+=p*(5*z),P+=h*(5*k),P+=y*(5*X),P+=b*(5*Z),P+=C*(5*s),S+=P>>>13,P&=8191,O=S,O+=M*s,O+=U*F,O+=E*D,O+=d*N,O+=l*(5*J),S=O>>>13,O&=8191,O+=p*(5*W),O+=h*(5*z),O+=y*(5*k),O+=b*(5*X),O+=C*(5*Z),S+=O>>>13,O&=8191,R=S,R+=M*Z,R+=U*s,R+=E*F,R+=d*D,R+=l*N,S=R>>>13,R&=8191,R+=p*(5*J),R+=h*(5*W),R+=y*(5*z),R+=b*(5*k),R+=C*(5*X),S+=R>>>13,R&=8191,K=S,K+=M*X,K+=U*Z,K+=E*s,K+=d*F,K+=l*D,S=K>>>13,K&=8191,K+=p*N,K+=h*(5*J),K+=y*(5*W),K+=b*(5*z),K+=C*(5*k),S+=K>>>13,K&=8191,Y=S,Y+=M*k,Y+=U*X,Y+=E*Z,Y+=d*s,Y+=l*F,S=Y>>>13,Y&=8191,Y+=p*D,Y+=h*N,Y+=y*(5*J),Y+=b*(5*W),Y+=C*(5*z),S+=Y>>>13,Y&=8191,A=S,A+=M*z,A+=U*k,A+=E*X,A+=d*Z,A+=l*s,S=A>>>13,A&=8191,A+=p*F,A+=h*D,A+=y*N,A+=b*(5*J),A+=C*(5*W),S+=A>>>13,A&=8191,j=S,j+=M*W,j+=U*z,j+=E*k,j+=d*X,j+=l*Z,S=j>>>13,j&=8191,j+=p*s,j+=h*F,j+=y*D,j+=b*N,j+=C*(5*J),S+=j>>>13,j&=8191,B=S,B+=M*J,B+=U*W,B+=E*z,B+=d*k,B+=l*X,S=B>>>13,B&=8191,B+=p*Z,B+=h*s,B+=y*F,B+=b*D,B+=C*N,S+=B>>>13,B&=8191,S=(S<<2)+S|0,S=S+$|0,$=S&8191,S=S>>>13,I+=S,M=$,U=I,E=P,d=O,l=R,p=K,h=Y,y=A,b=j,C=B,r+=16,f-=16;this.h[0]=M,this.h[1]=U,this.h[2]=E,this.h[3]=d,this.h[4]=l,this.h[5]=p,this.h[6]=h,this.h[7]=y,this.h[8]=b,this.h[9]=C},ke.prototype.finish=function(t,r){var f=new Uint16Array(10),e,n,c,x;if(this.leftover){for(x=this.leftover,this.buffer[x++]=1;x<16;x++)this.buffer[x]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(e=this.h[1]>>>13,this.h[1]&=8191,x=2;x<10;x++)this.h[x]+=e,e=this.h[x]>>>13,this.h[x]&=8191;for(this.h[0]+=e*5,e=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=e,e=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=e,f[0]=this.h[0]+5,e=f[0]>>>13,f[0]&=8191,x=1;x<10;x++)f[x]=this.h[x]+e,e=f[x]>>>13,f[x]&=8191;for(f[9]-=8192,n=(e^1)-1,x=0;x<10;x++)f[x]&=n;for(n=~n,x=0;x<10;x++)this.h[x]=this.h[x]&n|f[x];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,c=this.h[0]+this.pad[0],this.h[0]=c&65535,x=1;x<8;x++)c=(this.h[x]+this.pad[x]|0)+(c>>>16)|0,this.h[x]=c&65535;t[r+0]=this.h[0]>>>0&255,t[r+1]=this.h[0]>>>8&255,t[r+2]=this.h[1]>>>0&255,t[r+3]=this.h[1]>>>8&255,t[r+4]=this.h[2]>>>0&255,t[r+5]=this.h[2]>>>8&255,t[r+6]=this.h[3]>>>0&255,t[r+7]=this.h[3]>>>8&255,t[r+8]=this.h[4]>>>0&255,t[r+9]=this.h[4]>>>8&255,t[r+10]=this.h[5]>>>0&255,t[r+11]=this.h[5]>>>8&255,t[r+12]=this.h[6]>>>0&255,t[r+13]=this.h[6]>>>8&255,t[r+14]=this.h[7]>>>0&255,t[r+15]=this.h[7]>>>8&255},ke.prototype.update=function(t,r,f){var e,n;if(this.leftover){for(n=16-this.leftover,n>f&&(n=f),e=0;e<n;e++)this.buffer[this.leftover+e]=t[r+e];if(f-=n,r+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(f>=16&&(n=f-f%16,this.blocks(t,r,n),r+=n,f-=n),f){for(e=0;e<f;e++)this.buffer[this.leftover+e]=t[r+e];this.leftover+=f}};function ht(t,r,f,e,n,c){var x=new ke(c);return x.update(f,e,n),x.finish(t,r),0}function qt(t,r,f,e,n,c){var x=new Uint8Array(16);return ht(x,0,f,e,n,c),Ht(t,r,x,0)}function ut(t,r,f,e,n){var c;if(f<32)return-1;for(lt(t,0,r,0,f,e,n),ht(t,16,t,32,f-32,t),c=0;c<16;c++)t[c]=0;return 0}function yt(t,r,f,e,n){var c,x=new Uint8Array(32);if(f<32||(Gt(x,0,32,e,n),qt(r,16,r,32,f-32,x)!==0))return-1;for(lt(t,0,r,0,f,e,n),c=0;c<32;c++)t[c]=0;return 0}function _e(t,r){var f;for(f=0;f<16;f++)t[f]=r[f]|0}function pt(t){var r,f,e=1;for(r=0;r<16;r++)f=t[r]+e+65535,e=Math.floor(f/65536),t[r]=f-e*65536;t[0]+=e-1+37*(e-1)}function $e(t,r,f){for(var e,n=~(f-1),c=0;c<16;c++)e=n&(t[c]^r[c]),t[c]^=e,r[c]^=e}function Ie(t,r){var f,e,n,c=i(),x=i();for(f=0;f<16;f++)x[f]=r[f];for(pt(x),pt(x),pt(x),e=0;e<2;e++){for(c[0]=x[0]-65517,f=1;f<15;f++)c[f]=x[f]-65535-(c[f-1]>>16&1),c[f-1]&=65535;c[15]=x[15]-32767-(c[14]>>16&1),n=c[15]>>16&1,c[14]&=65535,$e(x,c,1-n)}for(f=0;f<16;f++)t[2*f]=x[f]&255,t[2*f+1]=x[f]>>8}function Wt(t,r){var f=new Uint8Array(32),e=new Uint8Array(32);return Ie(f,t),Ie(e,r),dt(f,0,e,0)}function Jt(t){var r=new Uint8Array(32);return Ie(r,t),r[0]&1}function bt(t,r){var f;for(f=0;f<16;f++)t[f]=r[2*f]+(r[2*f+1]<<8);t[15]&=32767}function pe(t,r,f){for(var e=0;e<16;e++)t[e]=r[e]+f[e]}function be(t,r,f){for(var e=0;e<16;e++)t[e]=r[e]-f[e]}function q(t,r,f){var e,n,c=0,x=0,u=0,g=0,T=0,L=0,V=0,S=0,$=0,I=0,P=0,O=0,R=0,K=0,Y=0,A=0,j=0,B=0,M=0,U=0,E=0,d=0,l=0,p=0,h=0,y=0,b=0,C=0,N=0,D=0,F=0,s=f[0],Z=f[1],X=f[2],k=f[3],z=f[4],W=f[5],J=f[6],oe=f[7],ee=f[8],fe=f[9],re=f[10],ne=f[11],ae=f[12],ce=f[13],xe=f[14],de=f[15];e=r[0],c+=e*s,x+=e*Z,u+=e*X,g+=e*k,T+=e*z,L+=e*W,V+=e*J,S+=e*oe,$+=e*ee,I+=e*fe,P+=e*re,O+=e*ne,R+=e*ae,K+=e*ce,Y+=e*xe,A+=e*de,e=r[1],x+=e*s,u+=e*Z,g+=e*X,T+=e*k,L+=e*z,V+=e*W,S+=e*J,$+=e*oe,I+=e*ee,P+=e*fe,O+=e*re,R+=e*ne,K+=e*ae,Y+=e*ce,A+=e*xe,j+=e*de,e=r[2],u+=e*s,g+=e*Z,T+=e*X,L+=e*k,V+=e*z,S+=e*W,$+=e*J,I+=e*oe,P+=e*ee,O+=e*fe,R+=e*re,K+=e*ne,Y+=e*ae,A+=e*ce,j+=e*xe,B+=e*de,e=r[3],g+=e*s,T+=e*Z,L+=e*X,V+=e*k,S+=e*z,$+=e*W,I+=e*J,P+=e*oe,O+=e*ee,R+=e*fe,K+=e*re,Y+=e*ne,A+=e*ae,j+=e*ce,B+=e*xe,M+=e*de,e=r[4],T+=e*s,L+=e*Z,V+=e*X,S+=e*k,$+=e*z,I+=e*W,P+=e*J,O+=e*oe,R+=e*ee,K+=e*fe,Y+=e*re,A+=e*ne,j+=e*ae,B+=e*ce,M+=e*xe,U+=e*de,e=r[5],L+=e*s,V+=e*Z,S+=e*X,$+=e*k,I+=e*z,P+=e*W,O+=e*J,R+=e*oe,K+=e*ee,Y+=e*fe,A+=e*re,j+=e*ne,B+=e*ae,M+=e*ce,U+=e*xe,E+=e*de,e=r[6],V+=e*s,S+=e*Z,$+=e*X,I+=e*k,P+=e*z,O+=e*W,R+=e*J,K+=e*oe,Y+=e*ee,A+=e*fe,j+=e*re,B+=e*ne,M+=e*ae,U+=e*ce,E+=e*xe,d+=e*de,e=r[7],S+=e*s,$+=e*Z,I+=e*X,P+=e*k,O+=e*z,R+=e*W,K+=e*J,Y+=e*oe,A+=e*ee,j+=e*fe,B+=e*re,M+=e*ne,U+=e*ae,E+=e*ce,d+=e*xe,l+=e*de,e=r[8],$+=e*s,I+=e*Z,P+=e*X,O+=e*k,R+=e*z,K+=e*W,Y+=e*J,A+=e*oe,j+=e*ee,B+=e*fe,M+=e*re,U+=e*ne,E+=e*ae,d+=e*ce,l+=e*xe,p+=e*de,e=r[9],I+=e*s,P+=e*Z,O+=e*X,R+=e*k,K+=e*z,Y+=e*W,A+=e*J,j+=e*oe,B+=e*ee,M+=e*fe,U+=e*re,E+=e*ne,d+=e*ae,l+=e*ce,p+=e*xe,h+=e*de,e=r[10],P+=e*s,O+=e*Z,R+=e*X,K+=e*k,Y+=e*z,A+=e*W,j+=e*J,B+=e*oe,M+=e*ee,U+=e*fe,E+=e*re,d+=e*ne,l+=e*ae,p+=e*ce,h+=e*xe,y+=e*de,e=r[11],O+=e*s,R+=e*Z,K+=e*X,Y+=e*k,A+=e*z,j+=e*W,B+=e*J,M+=e*oe,U+=e*ee,E+=e*fe,d+=e*re,l+=e*ne,p+=e*ae,h+=e*ce,y+=e*xe,b+=e*de,e=r[12],R+=e*s,K+=e*Z,Y+=e*X,A+=e*k,j+=e*z,B+=e*W,M+=e*J,U+=e*oe,E+=e*ee,d+=e*fe,l+=e*re,p+=e*ne,h+=e*ae,y+=e*ce,b+=e*xe,C+=e*de,e=r[13],K+=e*s,Y+=e*Z,A+=e*X,j+=e*k,B+=e*z,M+=e*W,U+=e*J,E+=e*oe,d+=e*ee,l+=e*fe,p+=e*re,h+=e*ne,y+=e*ae,b+=e*ce,C+=e*xe,N+=e*de,e=r[14],Y+=e*s,A+=e*Z,j+=e*X,B+=e*k,M+=e*z,U+=e*W,E+=e*J,d+=e*oe,l+=e*ee,p+=e*fe,h+=e*re,y+=e*ne,b+=e*ae,C+=e*ce,N+=e*xe,D+=e*de,e=r[15],A+=e*s,j+=e*Z,B+=e*X,M+=e*k,U+=e*z,E+=e*W,d+=e*J,l+=e*oe,p+=e*ee,h+=e*fe,y+=e*re,b+=e*ne,C+=e*ae,N+=e*ce,D+=e*xe,F+=e*de,c+=38*j,x+=38*B,u+=38*M,g+=38*U,T+=38*E,L+=38*d,V+=38*l,S+=38*p,$+=38*h,I+=38*y,P+=38*b,O+=38*C,R+=38*N,K+=38*D,Y+=38*F,n=1,e=c+n+65535,n=Math.floor(e/65536),c=e-n*65536,e=x+n+65535,n=Math.floor(e/65536),x=e-n*65536,e=u+n+65535,n=Math.floor(e/65536),u=e-n*65536,e=g+n+65535,n=Math.floor(e/65536),g=e-n*65536,e=T+n+65535,n=Math.floor(e/65536),T=e-n*65536,e=L+n+65535,n=Math.floor(e/65536),L=e-n*65536,e=V+n+65535,n=Math.floor(e/65536),V=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=$+n+65535,n=Math.floor(e/65536),$=e-n*65536,e=I+n+65535,n=Math.floor(e/65536),I=e-n*65536,e=P+n+65535,n=Math.floor(e/65536),P=e-n*65536,e=O+n+65535,n=Math.floor(e/65536),O=e-n*65536,e=R+n+65535,n=Math.floor(e/65536),R=e-n*65536,e=K+n+65535,n=Math.floor(e/65536),K=e-n*65536,e=Y+n+65535,n=Math.floor(e/65536),Y=e-n*65536,e=A+n+65535,n=Math.floor(e/65536),A=e-n*65536,c+=n-1+37*(n-1),n=1,e=c+n+65535,n=Math.floor(e/65536),c=e-n*65536,e=x+n+65535,n=Math.floor(e/65536),x=e-n*65536,e=u+n+65535,n=Math.floor(e/65536),u=e-n*65536,e=g+n+65535,n=Math.floor(e/65536),g=e-n*65536,e=T+n+65535,n=Math.floor(e/65536),T=e-n*65536,e=L+n+65535,n=Math.floor(e/65536),L=e-n*65536,e=V+n+65535,n=Math.floor(e/65536),V=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=$+n+65535,n=Math.floor(e/65536),$=e-n*65536,e=I+n+65535,n=Math.floor(e/65536),I=e-n*65536,e=P+n+65535,n=Math.floor(e/65536),P=e-n*65536,e=O+n+65535,n=Math.floor(e/65536),O=e-n*65536,e=R+n+65535,n=Math.floor(e/65536),R=e-n*65536,e=K+n+65535,n=Math.floor(e/65536),K=e-n*65536,e=Y+n+65535,n=Math.floor(e/65536),Y=e-n*65536,e=A+n+65535,n=Math.floor(e/65536),A=e-n*65536,c+=n-1+37*(n-1),t[0]=c,t[1]=x,t[2]=u,t[3]=g,t[4]=T,t[5]=L,t[6]=V,t[7]=S,t[8]=$,t[9]=I,t[10]=P,t[11]=O,t[12]=R,t[13]=K,t[14]=Y,t[15]=A}function ue(t,r){q(t,r,r)}function Vt(t,r){var f=i(),e;for(e=0;e<16;e++)f[e]=r[e];for(e=253;e>=0;e--)ue(f,f),e!==2&&e!==4&&q(f,f,r);for(e=0;e<16;e++)t[e]=f[e]}function Xt(t,r){var f=i(),e;for(e=0;e<16;e++)f[e]=r[e];for(e=250;e>=0;e--)ue(f,f),e!==1&&q(f,f,r);for(e=0;e<16;e++)t[e]=f[e]}function Qe(t,r,f){var e=new Uint8Array(32),n=new Float64Array(80),c,x,u=i(),g=i(),T=i(),L=i(),V=i(),S=i();for(x=0;x<31;x++)e[x]=r[x];for(e[31]=r[31]&127|64,e[0]&=248,bt(n,f),x=0;x<16;x++)g[x]=n[x],L[x]=u[x]=T[x]=0;for(u[0]=L[0]=1,x=254;x>=0;--x)c=e[x>>>3]>>>(x&7)&1,$e(u,g,c),$e(T,L,c),pe(V,u,T),be(u,u,T),pe(T,g,L),be(g,g,L),ue(L,V),ue(S,u),q(u,T,u),q(T,g,V),pe(V,u,T),be(u,u,T),ue(g,u),be(T,L,S),q(u,T,Se),pe(u,u,L),q(T,T,u),q(u,L,S),q(L,g,n),ue(g,V),$e(u,g,c),$e(T,L,c);for(x=0;x<16;x++)n[x+16]=u[x],n[x+32]=T[x],n[x+48]=g[x],n[x+64]=L[x];var $=n.subarray(32),I=n.subarray(16);return Vt($,$),q(I,I,$),Ie(t,I),0}function et(t,r){return Qe(t,r,H)}function kt(t,r){return m(r,32),et(t,r)}function tt(t,r,f){var e=new Uint8Array(32);return Qe(e,f,r),Xe(t,_,e,Ae)}var Qt=ut,jf=yt;function Cf(t,r,f,e,n,c){var x=new Uint8Array(32);return tt(x,n,c),Qt(t,r,f,e,x)}function $f(t,r,f,e,n,c){var x=new Uint8Array(32);return tt(x,n,c),jf(t,r,f,e,x)}var ef=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function tf(t,r,f,e){for(var n=new Int32Array(16),c=new Int32Array(16),x,u,g,T,L,V,S,$,I,P,O,R,K,Y,A,j,B,M,U,E,d,l,p,h,y,b,C=t[0],N=t[1],D=t[2],F=t[3],s=t[4],Z=t[5],X=t[6],k=t[7],z=r[0],W=r[1],J=r[2],oe=r[3],ee=r[4],fe=r[5],re=r[6],ne=r[7],ae=0;e>=128;){for(U=0;U<16;U++)E=8*U+ae,n[U]=f[E+0]<<24|f[E+1]<<16|f[E+2]<<8|f[E+3],c[U]=f[E+4]<<24|f[E+5]<<16|f[E+6]<<8|f[E+7];for(U=0;U<80;U++)if(x=C,u=N,g=D,T=F,L=s,V=Z,S=X,$=k,I=z,P=W,O=J,R=oe,K=ee,Y=fe,A=re,j=ne,d=k,l=ne,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=(s>>>14|ee<<18)^(s>>>18|ee<<14)^(ee>>>9|s<<23),l=(ee>>>14|s<<18)^(ee>>>18|s<<14)^(s>>>9|ee<<23),p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,d=s&Z^~s&X,l=ee&fe^~ee&re,p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,d=ef[U*2],l=ef[U*2+1],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,d=n[U%16],l=c[U%16],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,B=y&65535|b<<16,M=p&65535|h<<16,d=B,l=M,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=(C>>>28|z<<4)^(z>>>2|C<<30)^(z>>>7|C<<25),l=(z>>>28|C<<4)^(C>>>2|z<<30)^(C>>>7|z<<25),p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,d=C&N^C&D^N&D,l=z&W^z&J^W&J,p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,$=y&65535|b<<16,j=p&65535|h<<16,d=T,l=R,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=B,l=M,p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,T=y&65535|b<<16,R=p&65535|h<<16,N=x,D=u,F=g,s=T,Z=L,X=V,k=S,C=$,W=I,J=P,oe=O,ee=R,fe=K,re=Y,ne=A,z=j,U%16===15)for(E=0;E<16;E++)d=n[E],l=c[E],p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=n[(E+9)%16],l=c[(E+9)%16],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,B=n[(E+1)%16],M=c[(E+1)%16],d=(B>>>1|M<<31)^(B>>>8|M<<24)^B>>>7,l=(M>>>1|B<<31)^(M>>>8|B<<24)^(M>>>7|B<<25),p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,B=n[(E+14)%16],M=c[(E+14)%16],d=(B>>>19|M<<13)^(M>>>29|B<<3)^B>>>6,l=(M>>>19|B<<13)^(B>>>29|M<<3)^(M>>>6|B<<26),p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,n[E]=y&65535|b<<16,c[E]=p&65535|h<<16;d=C,l=z,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[0],l=r[0],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[0]=C=y&65535|b<<16,r[0]=z=p&65535|h<<16,d=N,l=W,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[1],l=r[1],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[1]=N=y&65535|b<<16,r[1]=W=p&65535|h<<16,d=D,l=J,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[2],l=r[2],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[2]=D=y&65535|b<<16,r[2]=J=p&65535|h<<16,d=F,l=oe,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[3],l=r[3],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[3]=F=y&65535|b<<16,r[3]=oe=p&65535|h<<16,d=s,l=ee,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[4],l=r[4],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[4]=s=y&65535|b<<16,r[4]=ee=p&65535|h<<16,d=Z,l=fe,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[5],l=r[5],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[5]=Z=y&65535|b<<16,r[5]=fe=p&65535|h<<16,d=X,l=re,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[6],l=r[6],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[6]=X=y&65535|b<<16,r[6]=re=p&65535|h<<16,d=k,l=ne,p=l&65535,h=l>>>16,y=d&65535,b=d>>>16,d=t[7],l=r[7],p+=l&65535,h+=l>>>16,y+=d&65535,b+=d>>>16,h+=p>>>16,y+=h>>>16,b+=y>>>16,t[7]=k=y&65535|b<<16,r[7]=ne=p&65535|h<<16,ae+=128,e-=128}return e}function Me(t,r,f){var e=new Int32Array(8),n=new Int32Array(8),c=new Uint8Array(256),x,u=f;for(e[0]=1779033703,e[1]=3144134277,e[2]=1013904242,e[3]=2773480762,e[4]=1359893119,e[5]=2600822924,e[6]=528734635,e[7]=1541459225,n[0]=4089235720,n[1]=2227873595,n[2]=4271175723,n[3]=1595750129,n[4]=2917565137,n[5]=725511199,n[6]=4215389547,n[7]=327033209,tf(e,n,r,f),f%=128,x=0;x<f;x++)c[x]=r[u-f+x];for(c[f]=128,f=256-128*(f<112?1:0),c[f-9]=0,Dt(c,f-8,u/536870912|0,u<<3),tf(e,n,c,f),x=0;x<8;x++)Dt(t,8*x,e[x],n[x]);return 0}function ft(t,r){var f=i(),e=i(),n=i(),c=i(),x=i(),u=i(),g=i(),T=i(),L=i();be(f,t[1],t[0]),be(L,r[1],r[0]),q(f,f,L),pe(e,t[0],t[1]),pe(L,r[0],r[1]),q(e,e,L),q(n,t[3],r[3]),q(n,n,Af),q(c,t[2],r[2]),pe(c,c,c),be(x,e,f),be(u,c,n),pe(g,c,n),pe(T,e,f),q(t[0],x,u),q(t[1],T,g),q(t[2],g,u),q(t[3],x,T)}function ff(t,r,f){var e;for(e=0;e<4;e++)$e(t[e],r[e],f)}function mt(t,r){var f=i(),e=i(),n=i();Vt(n,r[2]),q(f,r[0],n),q(e,r[1],n),Ie(t,e),t[31]^=Jt(f)<<7}function gt(t,r,f){var e,n;for(_e(t[0],te),_e(t[1],se),_e(t[2],se),_e(t[3],te),n=255;n>=0;--n)e=f[n/8|0]>>(n&7)&1,ff(t,r,e),ft(r,t),ft(t,t),ff(t,r,e)}function rt(t,r){var f=[i(),i(),i(),i()];_e(f[0],Nt),_e(f[1],Ft),_e(f[2],se),q(f[3],Nt,Ft),gt(t,f,r)}function vt(t,r,f){var e=new Uint8Array(64),n=[i(),i(),i(),i()],c;for(f||m(r,32),Me(e,r,32),e[0]&=248,e[31]&=127,e[31]|=64,rt(n,e),mt(t,n),c=0;c<32;c++)r[c+32]=t[c];return 0}var nt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function _t(t,r){var f,e,n,c;for(e=63;e>=32;--e){for(f=0,n=e-32,c=e-12;n<c;++n)r[n]+=f-16*r[e]*nt[n-(e-32)],f=Math.floor((r[n]+128)/256),r[n]-=f*256;r[n]+=f,r[e]=0}for(f=0,n=0;n<32;n++)r[n]+=f-(r[31]>>4)*nt[n],f=r[n]>>8,r[n]&=255;for(n=0;n<32;n++)r[n]-=f*nt[n];for(e=0;e<32;e++)r[e+1]+=r[e]>>8,t[e]=r[e]&255}function wt(t){var r=new Float64Array(64),f;for(f=0;f<64;f++)r[f]=t[f];for(f=0;f<64;f++)t[f]=0;_t(t,r)}function rf(t,r,f,e){var n=new Uint8Array(64),c=new Uint8Array(64),x=new Uint8Array(64),u,g,T=new Float64Array(64),L=[i(),i(),i(),i()];Me(n,e,32),n[0]&=248,n[31]&=127,n[31]|=64;var V=f+64;for(u=0;u<f;u++)t[64+u]=r[u];for(u=0;u<32;u++)t[32+u]=n[32+u];for(Me(x,t.subarray(32),f+32),wt(x),rt(L,x),mt(t,L),u=32;u<64;u++)t[u]=e[u];for(Me(c,t,f+64),wt(c),u=0;u<64;u++)T[u]=0;for(u=0;u<32;u++)T[u]=x[u];for(u=0;u<32;u++)for(g=0;g<32;g++)T[u+g]+=c[u]*n[g];return _t(t.subarray(32),T),V}function If(t,r){var f=i(),e=i(),n=i(),c=i(),x=i(),u=i(),g=i();return _e(t[2],se),bt(t[1],r),ue(n,t[1]),q(c,n,Pt),be(n,n,t[2]),pe(c,t[2],c),ue(x,c),ue(u,x),q(g,u,x),q(f,g,n),q(f,f,c),Xt(f,f),q(f,f,n),q(f,f,c),q(f,f,c),q(t[0],f,c),ue(e,t[0]),q(e,e,c),Wt(e,n)&&q(t[0],t[0],Mf),ue(e,t[0]),q(e,e,c),Wt(e,n)?-1:(Jt(t[0])===r[31]>>7&&be(t[0],te,t[0]),q(t[3],t[0],t[1]),0)}function Et(t,r,f,e){var n,c=new Uint8Array(32),x=new Uint8Array(64),u=[i(),i(),i(),i()],g=[i(),i(),i(),i()];if(f<64||If(g,e))return-1;for(n=0;n<f;n++)t[n]=r[n];for(n=0;n<32;n++)t[n+32]=e[n];if(Me(x,t,f),wt(x),gt(u,g,x),rt(g,r.subarray(32)),ft(u,g),mt(c,u),f-=64,dt(r,0,c,0)){for(n=0;n<f;n++)t[n]=0;return-1}for(n=0;n<f;n++)t[n]=r[n+64];return f}var Lt=32,ot=24,He=32,Re=16,ze=32,st=32,Ze=32,Ge=32,Bt=32,nf=ot,Rf=He,Yf=Re,we=64,Ue=32,Ye=64,St=32,At=64;o.lowlevel={crypto_core_hsalsa20:Xe,crypto_stream_xor:lt,crypto_stream:Gt,crypto_stream_salsa20_xor:zt,crypto_stream_salsa20:Zt,crypto_onetimeauth:ht,crypto_onetimeauth_verify:qt,crypto_verify_16:Ht,crypto_verify_32:dt,crypto_secretbox:ut,crypto_secretbox_open:yt,crypto_scalarmult:Qe,crypto_scalarmult_base:et,crypto_box_beforenm:tt,crypto_box_afternm:Qt,crypto_box:Cf,crypto_box_open:$f,crypto_box_keypair:kt,crypto_hash:Me,crypto_sign:rf,crypto_sign_keypair:vt,crypto_sign_open:Et,crypto_secretbox_KEYBYTES:Lt,crypto_secretbox_NONCEBYTES:ot,crypto_secretbox_ZEROBYTES:He,crypto_secretbox_BOXZEROBYTES:Re,crypto_scalarmult_BYTES:ze,crypto_scalarmult_SCALARBYTES:st,crypto_box_PUBLICKEYBYTES:Ze,crypto_box_SECRETKEYBYTES:Ge,crypto_box_BEFORENMBYTES:Bt,crypto_box_NONCEBYTES:nf,crypto_box_ZEROBYTES:Rf,crypto_box_BOXZEROBYTES:Yf,crypto_sign_BYTES:we,crypto_sign_PUBLICKEYBYTES:Ue,crypto_sign_SECRETKEYBYTES:Ye,crypto_sign_SEEDBYTES:St,crypto_hash_BYTES:At,gf:i,D:Pt,L:nt,pack25519:Ie,unpack25519:bt,M:q,A:pe,S:ue,Z:be,pow2523:Xt,add:ft,set25519:_e,modL:_t,scalarmult:gt,scalarbase:rt};function of(t,r){if(t.length!==Lt)throw new Error("bad key size");if(r.length!==ot)throw new Error("bad nonce size")}function Kf(t,r){if(t.length!==Ze)throw new Error("bad public key size");if(r.length!==Ge)throw new Error("bad secret key size")}function le(){for(var t=0;t<arguments.length;t++)if(!(arguments[t]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function sf(t){for(var r=0;r<t.length;r++)t[r]=0}o.randomBytes=function(t){var r=new Uint8Array(t);return m(r,t),r},o.secretbox=function(t,r,f){le(t,r,f),of(f,r);for(var e=new Uint8Array(He+t.length),n=new Uint8Array(e.length),c=0;c<t.length;c++)e[c+He]=t[c];return ut(n,e,e.length,r,f),n.subarray(Re)},o.secretbox.open=function(t,r,f){le(t,r,f),of(f,r);for(var e=new Uint8Array(Re+t.length),n=new Uint8Array(e.length),c=0;c<t.length;c++)e[c+Re]=t[c];return e.length<32||yt(n,e,e.length,r,f)!==0?null:n.subarray(He)},o.secretbox.keyLength=Lt,o.secretbox.nonceLength=ot,o.secretbox.overheadLength=Re,o.scalarMult=function(t,r){if(le(t,r),t.length!==st)throw new Error("bad n size");if(r.length!==ze)throw new Error("bad p size");var f=new Uint8Array(ze);return Qe(f,t,r),f},o.scalarMult.base=function(t){if(le(t),t.length!==st)throw new Error("bad n size");var r=new Uint8Array(ze);return et(r,t),r},o.scalarMult.scalarLength=st,o.scalarMult.groupElementLength=ze,o.box=function(t,r,f,e){var n=o.box.before(f,e);return o.secretbox(t,r,n)},o.box.before=function(t,r){le(t,r),Kf(t,r);var f=new Uint8Array(Bt);return tt(f,t,r),f},o.box.after=o.secretbox,o.box.open=function(t,r,f,e){var n=o.box.before(f,e);return o.secretbox.open(t,r,n)},o.box.open.after=o.secretbox.open,o.box.keyPair=function(){var t=new Uint8Array(Ze),r=new Uint8Array(Ge);return kt(t,r),{publicKey:t,secretKey:r}},o.box.keyPair.fromSecretKey=function(t){if(le(t),t.length!==Ge)throw new Error("bad secret key size");var r=new Uint8Array(Ze);return et(r,t),{publicKey:r,secretKey:new Uint8Array(t)}},o.box.publicKeyLength=Ze,o.box.secretKeyLength=Ge,o.box.sharedKeyLength=Bt,o.box.nonceLength=nf,o.box.overheadLength=o.secretbox.overheadLength,o.sign=function(t,r){if(le(t,r),r.length!==Ye)throw new Error("bad secret key size");var f=new Uint8Array(we+t.length);return rf(f,t,t.length,r),f},o.sign.open=function(t,r){if(le(t,r),r.length!==Ue)throw new Error("bad public key size");var f=new Uint8Array(t.length),e=Et(f,t,t.length,r);if(e<0)return null;for(var n=new Uint8Array(e),c=0;c<n.length;c++)n[c]=f[c];return n},o.sign.detached=function(t,r){for(var f=o.sign(t,r),e=new Uint8Array(we),n=0;n<e.length;n++)e[n]=f[n];return e},o.sign.detached.verify=function(t,r,f){if(le(t,r,f),r.length!==we)throw new Error("bad signature size");if(f.length!==Ue)throw new Error("bad public key size");var e=new Uint8Array(we+t.length),n=new Uint8Array(we+t.length),c;for(c=0;c<we;c++)e[c]=r[c];for(c=0;c<t.length;c++)e[c+we]=t[c];return Et(n,e,e.length,f)>=0},o.sign.keyPair=function(){var t=new Uint8Array(Ue),r=new Uint8Array(Ye);return vt(t,r),{publicKey:t,secretKey:r}},o.sign.keyPair.fromSecretKey=function(t){if(le(t),t.length!==Ye)throw new Error("bad secret key size");for(var r=new Uint8Array(Ue),f=0;f<r.length;f++)r[f]=t[32+f];return{publicKey:r,secretKey:new Uint8Array(t)}},o.sign.keyPair.fromSeed=function(t){if(le(t),t.length!==St)throw new Error("bad seed size");for(var r=new Uint8Array(Ue),f=new Uint8Array(Ye),e=0;e<32;e++)f[e]=t[e];return vt(r,f,!0),{publicKey:r,secretKey:f}},o.sign.publicKeyLength=Ue,o.sign.secretKeyLength=Ye,o.sign.seedLength=St,o.sign.signatureLength=we,o.hash=function(t){le(t);var r=new Uint8Array(At);return Me(r,t,t.length),r},o.hash.hashLength=At,o.verify=function(t,r){return le(t,r),t.length===0||r.length===0||t.length!==r.length?!1:xt(t,0,r,0,t.length)===0},o.setPRNG=function(t){m=t},function(){var t=typeof self<"u"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){var r=65536;o.setPRNG(function(f,e){var n,c=new Uint8Array(e);for(n=0;n<e;n+=r)t.getRandomValues(c.subarray(n,n+Math.min(e-n,r)));for(n=0;n<e;n++)f[n]=c[n];sf(c)})}else typeof Hf<"u"&&(t=Gf,t&&t.randomBytes&&o.setPRNG(function(f,e){var n,c=t.randomBytes(e);for(n=0;n<e;n++)f[n]=c[n];sf(c)}))}()})(a.exports?a.exports:self.nacl=self.nacl||{})})(yf);var qf=yf.exports;const ie=Ff(qf);var pf={exports:{}};(function(a){(function(o,i){a.exports?a.exports=i():(o.nacl||(o.nacl={}),o.nacl.util=i())})(Nf,function(){var o={};function i(m){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(m))throw new TypeError("invalid encoding")}return o.decodeUTF8=function(m){if(typeof m!="string")throw new TypeError("expected string");var _,H=unescape(encodeURIComponent(m)),te=new Uint8Array(H.length);for(_=0;_<H.length;_++)te[_]=H.charCodeAt(_);return te},o.encodeUTF8=function(m){var _,H=[];for(_=0;_<m.length;_++)H.push(String.fromCharCode(m[_]));return decodeURIComponent(escape(H.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(o.encodeBase64=function(m){return Buffer.from(m).toString("base64")},o.decodeBase64=function(m){return i(m),new Uint8Array(Array.prototype.slice.call(Buffer.from(m,"base64"),0))}):(o.encodeBase64=function(m){return new Buffer(m).toString("base64")},o.decodeBase64=function(m){return i(m),new Uint8Array(Array.prototype.slice.call(new Buffer(m,"base64"),0))}):(o.encodeBase64=function(m){var _,H=[],te=m.length;for(_=0;_<te;_++)H.push(String.fromCharCode(m[_]));return btoa(H.join(""))},o.decodeBase64=function(m){i(m);var _,H=atob(m),te=new Uint8Array(H.length);for(_=0;_<H.length;_++)te[_]=H.charCodeAt(_);return te}),o})})(pf);var Q=pf.exports;function Wf(){const a=ie.box.keyPair();return{publicKey:Q.encodeBase64(a.publicKey),secretKey:Q.encodeBase64(a.secretKey)}}function Jf(a){const o=`ghost_keys_${a}`;try{const m=localStorage.getItem(o);if(m){const _=JSON.parse(m);if(_.publicKey&&_.secretKey)return _}}catch{}const i=Wf();try{localStorage.setItem(o,JSON.stringify(i))}catch{}return i}function Vf(a,o,i){const m=ie.randomBytes(ie.box.nonceLength),_=Q.decodeUTF8(a),H=Q.decodeBase64(o),te=Q.decodeBase64(i),se=ie.box(_,m,H,te);if(!se)throw new Error("Encryption failed");return{payload:Q.encodeBase64(se),nonce:Q.encodeBase64(m)}}function af(a,o,i,m){const _=Q.decodeBase64(a),H=Q.decodeBase64(o),te=Q.decodeBase64(i),se=Q.decodeBase64(m),Se=ie.box.open(_,H,te,se);if(!Se)throw new Error("Decryption failed");return Q.encodeUTF8(Se)}function Ut(a){const o=ie.hash(Q.decodeUTF8(a));return Q.encodeBase64(o.slice(0,ie.secretbox.keyLength))}function Xf(a,o){const i=ie.randomBytes(ie.secretbox.nonceLength),m=Q.decodeBase64(o),_=ie.secretbox(Q.decodeUTF8(a),i,m);if(!_)throw new Error("Room encryption failed");return{payload:Q.encodeBase64(_),nonce:Q.encodeBase64(i)}}function kf(a,o,i){const m=ie.secretbox.open(Q.decodeBase64(a),Q.decodeBase64(o),Q.decodeBase64(i));if(!m)throw new Error("Room decryption failed");return Q.encodeUTF8(m)}function Qf(a){const o=ie.hash(Q.decodeUTF8(a));let i=BigInt(0);for(let m=0;m<31;m++)i=i<<BigInt(8)|BigInt(o[m]);return i.toString()+"field"}class er{constructor(o){Te(this,"ws",null);Te(this,"url");Te(this,"handlers",new Map);Te(this,"reconnectDelay",1e3);Te(this,"maxReconnectDelay",3e4);Te(this,"shouldReconnect",!0);this.url=o}connect(){this.shouldReconnect=!0,this.ws=new WebSocket(this.url),this.ws.onopen=()=>{console.log("[WS] Connected"),this.reconnectDelay=1e3,this.emit("_connected",{})},this.ws.onmessage=o=>{try{const i=JSON.parse(o.data);this.emit(i.type,i)}catch(i){console.error("[WS] Parse error:",i)}},this.ws.onclose=()=>{console.log("[WS] Disconnected"),this.emit("_disconnected",{}),this.shouldReconnect&&(setTimeout(()=>this.connect(),this.reconnectDelay),this.reconnectDelay=Math.min(this.reconnectDelay*2,this.maxReconnectDelay))},this.ws.onerror=()=>{var o;return(o=this.ws)==null?void 0:o.close()}}send(o){var i;((i=this.ws)==null?void 0:i.readyState)===WebSocket.OPEN&&this.ws.send(JSON.stringify(o))}on(o,i){const m=this.handlers.get(o)||[];m.push(i),this.handlers.set(o,m)}off(o,i){const m=this.handlers.get(o)||[];this.handlers.set(o,m.filter(_=>_!==i))}emit(o,i){const m=this.handlers.get(o)||[];for(const _ of m)try{_(i)}catch(H){console.error("[WS] Handler error:",H)}}disconnect(){var o;this.shouldReconnect=!1,(o=this.ws)==null||o.close()}get connected(){var o;return((o=this.ws)==null?void 0:o.readyState)===WebSocket.OPEN}}function tr(a,o){const i=ie.box.keyPair(),m=ie.randomBytes(ie.box.nonceLength),_=Q.decodeUTF8(a),H=Q.decodeBase64(o),te=ie.box(_,m,H,i.secretKey);if(!te)throw new Error("Secret encryption failed");const se=Qf(a);return{payload:Q.encodeBase64(te),ephemeralPk:Q.encodeBase64(i.publicKey),nonce:Q.encodeBase64(m),aleoHash:se}}function fr(a,o,i,m){const _=Q.decodeBase64(a),H=Q.decodeBase64(o),te=Q.decodeBase64(i),se=Q.decodeBase64(m),Se=ie.box.open(_,H,te,se);if(!Se)throw new Error("Secret decryption failed â€” message may have been tampered with");return Q.encodeUTF8(Se)}const rr="/api";async function it(a,o){const i=await fetch(`${rr}${a}`,{headers:{"Content-Type":"application/json"},...o});if(!i.ok)throw new Error(`API ${i.status}: ${i.statusText}`);return i.json()}async function nr(){return it("/rooms?type=channel")}async function or(a){return it(`/rooms?type=group&userId=${encodeURIComponent(a)}`)}async function sr(a,o=50,i=0){return it(`/messages/room/${a}?limit=${o}&offset=${i}`)}async function ar(a,o,i=50,m=0){return it(`/messages/dm/${a}/${o}?limit=${i}&offset=${m}`)}let Ke,Ee="",bf="";const ye=new Map,Le=new Map,Be=new Map,me=new Map;let v=null,Tt=new Map,je="",jt="channel";const ir=location.protocol==="https:"?`wss://${location.host}`:`ws://${location.hostname}:3001`,G=new er(ir),w=a=>document.querySelector(a),mf=w("#login-screen"),gf=w("#app-screen"),vf=w("#login-username"),Ce=w("#login-btn"),Ct=w("#conn-status"),cr=w("#my-username"),cf=w("#messages-list-view"),xf=w("#channels-list-view"),df=w("#groups-list-view"),lf=w("#users-list"),hf=w("#channels-list"),uf=w("#groups-list"),Ne=w("#chat-empty"),Fe=w("#chat-active"),$t=w("#chat-title"),he=w("#messages"),xr=w("#message-form"),Mt=w("#message-input"),at=w("#typing-indicator"),dr=w("#typing-user"),Oe=w("#leave-room-btn"),Je=w("#delete-room-btn"),ct=w("#clear-dm-btn");Ce.onclick=()=>_f();vf.onkeydown=a=>{a.key==="Enter"&&_f()};function _f(){const a=vf.value.trim();a&&(bf=a,Ke=Jf(a),G.connect(),G.on("_connected",()=>{G.send({type:"auth",username:a,publicKey:Ke.publicKey})}),Ce.disabled=!0,Ce.textContent="Connecting...")}G.on("auth_ok",a=>{Ee=a.userId,cr.textContent=bf;for(const o of a.users)ye.set(o.id,o);mf.classList.remove("active"),gf.classList.add("active"),Ct.classList.add("online"),lr(),hr(),De()});G.on("room_list",a=>{for(const o of a.rooms)o.type==="channel"?Le.set(o.id,{id:o.id,name:o.name,type:"channel",createdBy:o.createdBy}):o.type==="group"&&Be.set(o.id,{id:o.id,name:o.name,type:"group",createdBy:o.createdBy});ge(),ve()});G.on("error",a=>{console.error("[Ghost]",a.message),Ce.disabled=!1,Ce.textContent="Connect"});G.on("user_joined",a=>{ye.set(a.user.id,a.user),De()});G.on("user_left",a=>{ye.delete(a.userId),De()});G.on("room_created",a=>{const o=a.room;o.type==="channel"?(Le.set(o.id,{id:o.id,name:o.name,type:"channel",createdBy:o.createdBy}),ge()):o.type==="group"&&(Be.set(o.id,{id:o.id,name:o.name,type:"group",createdBy:o.createdBy}),ve())});G.on("room_joined",()=>{ge(),ve()});G.on("room_left",a=>{Le.has(a.roomId)&&ge(),Be.has(a.roomId)&&ve()});G.on("room_deleted",a=>{const o=a.roomId;Le.delete(o),Be.delete(o),me.delete(o),localStorage.removeItem(`ghost_roomkey_${o}`),ge(),ve(),v&&(v.type==="channel"||v.type==="group")&&v.id===o&&(v=null,Fe.classList.add("hidden"),Ne.style.display="",Oe.classList.add("hidden"),Je.classList.add("hidden"))});G.on("dm_cleared",a=>{v&&v.type==="dm"&&v.id===a.recipientId&&(he.innerHTML="",Ot("Chat history cleared"))});G.on("message",a=>{const o=a.message;if(v){const i=(v.type==="channel"||v.type==="group")&&o.roomId===v.id,m=v.type==="dm"&&(o.senderId===v.id||o.recipientId===v.id||o.senderId===Ee);(i||m)&&Kt(o)}});G.on("typing",a=>{const o=ye.get(a.userId);o&&(dr.textContent=o.username,at.classList.remove("hidden"),clearTimeout(at._timeout),at._timeout=setTimeout(()=>at.classList.add("hidden"),3e3))});G.on("secret_available",a=>{Tt.set(a.id,a);const o=ye.get(a.senderId);v&&v.type==="dm"&&v.id===a.senderId&&Ef(a.id,(o==null?void 0:o.username)||"Someone")});G.on("secret_data",a=>{const o=a.message;try{const i=fr(o.payload,o.nonce,o.ephemeralPk,Ke.secretKey);pr(i,o.aleoHash)}catch{alert("Failed to decrypt secret message")}});G.on("secret_read",()=>{Ot("ðŸ”¥ Your secret message was read and destroyed")});G.on("_disconnected",()=>{Ct.classList.remove("online")});G.on("_connected",()=>{Ct.classList.add("online")});document.querySelectorAll("#nav-bar .nav-icon[data-tab]").forEach(a=>{a.addEventListener("click",()=>{const o=a.dataset.tab;It(o)})});function It(a){var o;document.querySelectorAll("#nav-bar .nav-icon[data-tab]").forEach(i=>i.classList.remove("active")),(o=document.querySelector(`#nav-bar .nav-icon[data-tab="${a}"]`))==null||o.classList.add("active"),cf.classList.remove("active"),xf.classList.remove("active"),df.classList.remove("active"),a==="messages"?cf.classList.add("active"):a==="channels"?xf.classList.add("active"):a==="groups"&&df.classList.add("active")}async function lr(){try{const a=await nr();for(const o of a)Le.set(o.id,{id:o.id,name:o.name,type:"channel"});ge()}catch{}}function ge(){hf.innerHTML="";for(const[a,o]of Le){const i=document.createElement("li");i.innerHTML=`<span class="icon">ðŸ“¢</span><span class="name">${Pe(o.name)}</span>`,i.onclick=()=>Rt(a),(v==null?void 0:v.type)==="channel"&&v.id===a&&i.classList.add("active"),hf.appendChild(i)}}function Rt(a){const o=Le.get(a);if(o){if(!me.has(a)){je=a,jt="channel",w("#join-modal-title").textContent="Join Channel",Lf();return}v={type:"channel",id:a,name:o.name},$t.textContent=`ðŸ“¢ ${o.name}`,Ne.style.display="none",Fe.classList.remove("hidden"),Oe.classList.remove("hidden"),ct.classList.add("hidden"),Je.classList.toggle("hidden",o.createdBy!==Ee),he.innerHTML="",ge(),ve(),De(),wf(a)}}async function hr(){try{const a=await or(Ee);for(const o of a)Be.set(o.id,{id:o.id,name:o.name,type:"group"});ve()}catch{}}function ve(){uf.innerHTML="";for(const[a,o]of Be){const i=document.createElement("li");i.innerHTML=`<span class="icon">ðŸ‘¥</span><span class="name">${Pe(o.name)}</span>`,i.onclick=()=>Yt(a),(v==null?void 0:v.type)==="group"&&v.id===a&&i.classList.add("active"),uf.appendChild(i)}}function Yt(a){const o=Be.get(a);if(o){if(!me.has(a)){je=a,jt="group",w("#join-modal-title").textContent="Join Group",Lf();return}v={type:"group",id:a,name:o.name},$t.textContent=`ðŸ‘¥ ${o.name}`,Ne.style.display="none",Fe.classList.remove("hidden"),Oe.classList.remove("hidden"),ct.classList.add("hidden"),Je.classList.toggle("hidden",o.createdBy!==Ee),he.innerHTML="",ge(),ve(),De(),wf(a)}}function De(){lf.innerHTML="";for(const[a,o]of ye){if(a===Ee)continue;const i=document.createElement("li");i.innerHTML=`<span class="icon">ðŸ‘¤</span><span class="name">${Pe(o.username)}</span>`,i.onclick=()=>ur(a),(v==null?void 0:v.type)==="dm"&&v.id===a&&i.classList.add("active"),lf.appendChild(i)}}function ur(a){const o=ye.get(a);if(o){v={type:"dm",id:a,name:o.username},$t.textContent=`ðŸ”’ ${o.username}`,Ne.style.display="none",Fe.classList.remove("hidden"),Oe.classList.add("hidden"),Je.classList.add("hidden"),ct.classList.remove("hidden"),he.innerHTML="",ge(),ve(),De(),yr(a);for(const[i,m]of Tt)m.senderId===a&&Ef(i,o.username)}}async function wf(a){try{const o=await sr(a);for(const i of o)Kt(i)}catch{}}async function yr(a){try{const o=await ar(Ee,a);for(const i of o)Kt(i)}catch{}}xr.onsubmit=a=>{a.preventDefault();const o=Mt.value.trim();if(!(!o||!v)){if(v.type==="dm"){const i=ye.get(v.id);if(!i)return;const{payload:m,nonce:_}=Vf(o,i.publicKey,Ke.secretKey);G.send({type:"message",recipientId:v.id,payload:m,nonce:_})}else if(v.type==="channel"||v.type==="group"){const i=me.get(v.id);if(!i){alert("Missing room key");return}const{payload:m,nonce:_}=Xf(o,i);G.send({type:"message",roomId:v.id,payload:m,nonce:_})}Mt.value=""}};let qe=null;Mt.oninput=()=>{if(v){if(!qe){const a=v.type==="channel"||v.type==="group";G.send({type:"typing",...a?{roomId:v.id}:{recipientId:v.id}})}qe&&clearTimeout(qe),qe=setTimeout(()=>{qe=null},2e3)}};function Kt(a){const o=a.sender_id===Ee||a.senderId===Ee;let i="";try{if((v==null?void 0:v.type)==="dm"){const se=ye.get(v.id);se&&(i=af(a.payload,a.nonce,se.publicKey,Ke.secretKey))}else if((v==null?void 0:v.type)==="channel"||(v==null?void 0:v.type)==="group"){const se=me.get(v.id);se&&(i=kf(a.payload,a.nonce,se))}}catch{i="[Decryption Failed]"}i||(i="[Encrypted]");const m=a.sender_id||a.senderId,_=ye.get(m),H=new Date(Number(a.timestamp)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),te=document.createElement("div");te.className=`msg ${o?"mine":"theirs"}`,te.innerHTML=`
    ${o?"":`<div class="sender">${Pe((_==null?void 0:_.username)||"Unknown")}</div>`}
    <div>${Pe(i)}</div>
    <div class="time">${H}</div>
  `,he.appendChild(te),he.scrollTop=he.scrollHeight}function Ot(a){const o=document.createElement("div");o.className="msg secret-notification",o.innerHTML=a,he.appendChild(o),he.scrollTop=he.scrollHeight}function Ef(a,o){const i=document.createElement("div");i.className="msg secret-notification",i.innerHTML=`ðŸ¤« <strong>${Pe(o)}</strong> sent you a secret message. <em>Click to read (one-time only)</em>`,i.onclick=()=>{G.send({type:"read_secret",messageId:a}),Tt.delete(a),i.remove()},he.appendChild(i),he.scrollTop=he.scrollHeight}w("#create-channel-btn").addEventListener("click",()=>{w("#channel-modal").classList.remove("hidden")});w("#channel-cancel-btn").addEventListener("click",()=>{w("#channel-modal").classList.add("hidden")});w("#channel-create-btn").addEventListener("click",()=>{const a=w("#channel-name-input").value.trim(),o=w("#channel-pass-input").value;if(!a||!o){alert("Name and passphrase required");return}G.send({type:"create_room",name:a,isPrivate:!1,roomType:"channel"});const i=m=>{if(m.room.type==="channel"){const _=Ut(o);me.set(m.room.id,_),localStorage.setItem(`ghost_roomkey_${m.room.id}`,_),G.send({type:"join_room",roomId:m.room.id}),G.off("room_created",i),w("#channel-modal").classList.add("hidden"),w("#channel-name-input").value="",w("#channel-pass-input").value="",It("channels"),Rt(m.room.id)}};G.on("room_created",i)});w("#create-group-btn").addEventListener("click",()=>{w("#group-modal").classList.remove("hidden")});w("#group-cancel-btn").addEventListener("click",()=>{w("#group-modal").classList.add("hidden")});w("#group-create-btn").addEventListener("click",()=>{const a=w("#group-name-input").value.trim(),o=w("#group-pass-input").value;if(!a||!o){alert("Name and passphrase required");return}G.send({type:"create_room",name:a,isPrivate:!0,roomType:"group"});const i=m=>{if(m.room.type==="group"){const _=Ut(o);me.set(m.room.id,_),localStorage.setItem(`ghost_roomkey_${m.room.id}`,_),G.send({type:"join_room",roomId:m.room.id}),G.off("room_created",i),w("#group-modal").classList.add("hidden"),w("#group-name-input").value="",w("#group-pass-input").value="",It("groups"),Yt(m.room.id)}};G.on("room_created",i)});function Lf(){w("#join-modal").classList.remove("hidden")}w("#join-cancel-btn").addEventListener("click",()=>{w("#join-modal").classList.add("hidden")});w("#join-confirm-btn").addEventListener("click",()=>{const a=w("#join-pass-input").value;if(!a)return;const o=Ut(a);me.set(je,o),localStorage.setItem(`ghost_roomkey_${je}`,o),G.send({type:"join_room",roomId:je}),w("#join-modal").classList.add("hidden"),w("#join-pass-input").value="",jt==="channel"?Rt(je):Yt(je)});Oe.addEventListener("click",()=>{!v||v.type==="dm"||(G.send({type:"leave_room",roomId:v.id}),me.delete(v.id),localStorage.removeItem(`ghost_roomkey_${v.id}`),v.type==="channel"?(Le.delete(v.id),ge()):(Be.delete(v.id),ve()),v=null,Fe.classList.add("hidden"),Ne.style.display="",Oe.classList.add("hidden"))});Je.addEventListener("click",()=>{!v||v.type==="dm"||Bf(`Delete ${v.type==="channel"?"Channel":"Group"}`,`Are you sure you want to delete "${v.name}"? All messages will be permanently removed.`,()=>{G.send({type:"delete_room",roomId:v.id})})});ct.addEventListener("click",()=>{!v||v.type!=="dm"||Bf("Clear Chat",`Clear all messages with ${v.name}? This cannot be undone.`,()=>{G.send({type:"clear_dm",recipientId:v.id})})});let We=null;function Bf(a,o,i){w("#confirm-title").textContent=a,w("#confirm-text").textContent=o,We=i,w("#confirm-modal").classList.remove("hidden")}w("#confirm-cancel-btn").addEventListener("click",()=>{w("#confirm-modal").classList.add("hidden"),We=null});w("#confirm-ok-btn").addEventListener("click",()=>{w("#confirm-modal").classList.add("hidden"),We&&(We(),We=null)});w("#secret-btn").addEventListener("click",()=>{if(!v||v.type!=="dm"){alert("Secret messages work only in DMs");return}w("#secret-modal").classList.remove("hidden")});w("#secret-cancel-btn").addEventListener("click",()=>{w("#secret-modal").classList.add("hidden")});w("#secret-send-btn").addEventListener("click",()=>{const a=w("#secret-text").value.trim();if(!a||!v)return;const o=ye.get(v.id);if(!o)return;const i=tr(a,o.publicKey);G.send({type:"secret",recipientId:v.id,payload:i.payload,ephemeralPk:i.ephemeralPk,nonce:i.nonce,aleoHash:i.aleoHash}),Ot(`ðŸ¤« You sent a secret message (hash: ${i.aleoHash.slice(0,20)}...)`),w("#secret-modal").classList.add("hidden"),w("#secret-text").value=""});function pr(a,o){w("#secret-read-content").textContent=a,w("#secret-aleo-hash").textContent=`Aleo Hash: ${o}`,w("#secret-read-modal").classList.remove("hidden")}w("#secret-read-close-btn").addEventListener("click",()=>{w("#secret-read-content").textContent="",w("#secret-read-modal").classList.add("hidden")});w("#logout-btn").addEventListener("click",()=>{G.disconnect(),gf.classList.remove("active"),mf.classList.add("active"),Ce.disabled=!1,Ce.textContent="Connect",ye.clear(),Le.clear(),Be.clear(),v=null,Fe.classList.add("hidden"),Ne.style.display=""});for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o!=null&&o.startsWith("ghost_roomkey_")){const i=o.replace("ghost_roomkey_",""),m=localStorage.getItem(o);m&&me.set(i,m)}}const br=new IntersectionObserver(a=>{for(const o of a)o.isIntersecting&&o.target.classList.add("visible")},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".fade-in-up").forEach(a=>{br.observe(a)});function mr(){const a=document.getElementById("particles");if(a)for(let o=0;o<30;o++){const i=document.createElement("div");i.style.cssText=`
      position: absolute;
      width: ${2+Math.random()*3}px;
      height: ${2+Math.random()*3}px;
      background: rgba(255,140,0,${.1+Math.random()*.2});
      border-radius: 50%;
      left: ${Math.random()*100}%;
      top: ${Math.random()*100}%;
      animation: particleFloat ${5+Math.random()*10}s ease-in-out infinite;
      animation-delay: ${-Math.random()*10}s;
    `,a.appendChild(i)}}mr();const Sf=document.createElement("style");Sf.textContent=`
  @keyframes particleFloat {
    0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
    25% { transform: translate(20px, -30px) scale(1.5); opacity: 0.6; }
    50% { transform: translate(-15px, -60px) scale(1); opacity: 0.3; }
    75% { transform: translate(25px, -20px) scale(1.3); opacity: 0.5; }
  }
`;document.head.appendChild(Sf);function Pe(a){const o=document.createElement("span");return o.textContent=a,o.innerHTML}
//# sourceMappingURL=index-BBWuIFJy.js.map
